# QA –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PDM/mini-ERP System
## –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á—ë—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Ä–æ–≤–Ω—è Enterprise

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 12 —è–Ω–≤–∞—Ä—è 2026 –≥.  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 1.0  
**–°—Ç–µ–∫:** Django 5.0.14 + DRF + PostgreSQL + React + TypeScript + Vite

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫:** 12.01.2026 02:44:49

| –°—Ç–∞—Ç—É—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–æ—Ü–µ–Ω—Ç |
|--------|------------|---------|
| ‚úÖ Passed | 17 | 68% |
| ‚ùå Failed | 0 | 0% |
| ‚ö†Ô∏è Warnings | 4 | 16% |
| ‚è≠Ô∏è Skipped | 4 | 16% |
| **TOTAL** | **25** | 100% |

### ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏)

| ID | –ù–∞–∑–≤–∞–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----|----------|-------------|----------|
| SEC-003 | No Rate Limiting | üü† HIGH | –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| CRIT-002 | IDOR Vulnerability | üî¥ CRITICAL | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º |
| CRIT-003 | Race Condition | üî¥ CRITICAL | Endpoint recalculate –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∑–∞—â–∏—Ç—ã –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ |
| CRIT-004 | Unsafe CASCADE | üî¥ CRITICAL | CASCADE delete –Ω–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [Executive Summary](#executive-summary)
2. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏](#1-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–∏—Å–∫–∏-critical)
3. [Backend & API](#2-backend--api)
4. [–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞](#3-–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#4-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-postgresql)
6. [Frontend](#5-frontend)
7. [–†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø—ã](#6-—Ä–æ–ª–∏-–∏-–¥–æ—Å—Ç—É–ø—ã)
8. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#7-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-frontend--backend--db)
9. [–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã](#8-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ-–ø—Ä–æ—Ü–µ—Å—Å—ã)
10. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏](#9-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)

---

## Executive Summary

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | Critical | High | Medium | Low |
|-----------|----------|------|--------|-----|
| Backend/API | 3 | 8 | 12 | 5 |
| –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | 5 | 7 | 9 | 4 |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | 2 | 5 | 8 | 3 |
| Frontend | 1 | 4 | 10 | 6 |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 4 | 6 | 5 | 2 |
| **–ò–¢–û–ì–û** | **15** | **30** | **44** | **20** |

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production: üî¥ –ù–ï –ì–û–¢–û–í

---

## 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ (CRITICAL)

### üî¥ CRIT-001: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ BOM

**–§–∞–π–ª:** `presentation/api/v1/views/project.py:102-140`

```python
@action(detail=True, methods=['post'])
def generate_from_bom(self, request, pk=None):
    ...
    with transaction.atomic():
        # Clear existing items if requested
        if request.data.get('clear_existing', False):
            project.items.all().delete()  # ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö ‚Äî –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.

**–°—Ü–µ–Ω–∞—Ä–∏–π –æ—Ç–∫–∞–∑–∞:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑ BOM" —Å clear_existing=true
2. –£–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ items (–≤–∫–ª—é—á–∞—è —Å–≤—è–∑–∏ —Å –∑–∞–∫–∞–∑–∞–º–∏)
3. –ù–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –æ—à–∏–±–∫–∞ –ë–î –∏–ª–∏ timeout
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–æ–µ–∫—Ç –ø—É—Å—Ç–æ–π, –≤—Å–µ —Å–≤—è–∑–∏ –ø–æ—Ç–µ—Ä—è–Ω—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```python
with transaction.atomic():
    # –°–æ–∑–¥–∞—Ç—å snapshot –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
    old_items_backup = list(project.items.values())
    try:
        project.items.all().delete()
        # ... —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö
    except Exception:
        # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
        raise
```

---

### üî¥ CRIT-002: Race condition –≤ —Ä–∞—Å—á—ë—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–§–∞–π–ª:** `application/tasks/project_tasks.py:17-88`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ —Ä–∞—Å—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–æ–∂–µ—Ç –¥–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

```python
@shared_task(bind=True, max_retries=3)
def recalculate_project_progress(self, project_id: str):
    # ‚ö†Ô∏è –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∑–∞–ø–∏—Å–∏
    project = Project.objects.get(id=project_id)
    with transaction.atomic():
        items = project.items.all()  # ‚ö†Ô∏è –ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
```

**–°—Ü–µ–Ω–∞—Ä–∏–π –æ—Ç–∫–∞–∑–∞:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ê –æ–±–Ω–æ–≤–ª—è–µ—Ç item 1, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Å—á—ë—Ç
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë –æ–±–Ω–æ–≤–ª—è–µ—Ç item 2, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Å—á—ë—Ç
3. –û–±–∞ task —á–∏—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî –æ–¥–∏–Ω –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥—Ä—É–≥–æ–≥–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_for_update()` –∏ distributed lock (Redis).

---

### üî¥ CRIT-003: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–æ–≤

**–§–∞–π–ª:** `presentation/api/v1/views/procurement.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –æ–±—Ö–æ–¥ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —á–µ—Ä–µ–∑ PATCH.

```python
# –ú–æ–∂–Ω–æ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–ø—Ä–∞–≤–∏—Ç—å PATCH —Å –ª—é–±—ã–º —Å—Ç–∞—Ç—É—Å–æ–º:
# PATCH /api/v1/purchase-orders/123/ 
# { "status": "delivered" }
```

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ó–∞–∫–∞–∑ –≤ —Å—Ç–∞—Ç—É—Å–µ "draft"
2. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫/–æ—à–∏–±–∫–∞ ‚Üí PATCH status="delivered"
3. –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç —Ç–æ–≤–∞—Ä –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø–æ—Å—Ç–∞–≤–∫–∏
4. –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏

---

### üî¥ CRIT-004: –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å CASCADE

**–§–∞–π–ª:** `infrastructure/persistence/models/project.py:180`

```python
nomenclature_item = models.ForeignKey(
    NomenclatureItem,
    on_delete=models.CASCADE,  # ‚ö†Ô∏è –û–ü–ê–°–ù–û!
    related_name='project_items',
)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã —É–¥–∞–ª–∏—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ project_items –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É–¥–∞–ª—è–µ—Ç –Ω–µ–Ω—É–∂–Ω—É—é –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—É
2. CASCADE —É–¥–∞–ª—è–µ—Ç –≤—Å–µ project_items –≤–æ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
3. –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –æ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤

---

### üî¥ CRIT-005: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–±—ä–µ–∫—Ç–æ–≤

**–§–∞–π–ª:** `presentation/api/v1/views/base.py`

```python
class BaseModelViewSet(...):
    permission_classes = [IsAuthenticated]  # ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ—é–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## 2. Backend & API

### HIGH-001: –ù–µ—Ç rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö endpoints

**–£—è–∑–≤–∏–º—ã–µ endpoints:**
- `POST /api/v1/auth/login/` ‚Äî brute force
- `POST /api/v1/projects/{id}/generate-from-bom/` ‚Äî DoS
- `POST /api/v1/projects/{id}/recalculate/` ‚Äî —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

**–¢–µ—Å—Ç:**
```bash
# Brute force login
for i in {1..1000}; do
  curl -X POST http://localhost:8000/api/v1/auth/login/ \
    -d '{"username":"admin","password":"wrong'$i'"}'
done
```

---

### HIGH-002: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

**–§–∞–π–ª:** `serializers/project.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª:
- `planned_end` < `planned_start`
- `progress_percent` > 100
- `quantity` < 0

**–ß–µ–∫-–ª–∏—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- [ ] –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è >= –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞
- [ ] –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ 0-100
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0
- [ ] required_date –≤ –±—É–¥—É—â–µ–º (–¥–ª—è –Ω–æ–≤—ã—Ö)
- [ ] –ù–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å contractor –¥–ª—è –∑–∞–∫—É–ø–∞–µ–º–æ–π –ø–æ–∑–∏—Ü–∏–∏

---

### HIGH-003: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤—Å–µ –ø–æ–ª—è, –≤–∫–ª—é—á–∞—è sensitive.

```python
class ContractorDetailSerializer(BaseModelSerializer):
    class Meta:
        fields = [
            'id', 'name', ..., 
            'contract_number',  # ‚ö†Ô∏è –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è —Ç–∞–π–Ω–∞
            'rating',  # ‚ö†Ô∏è –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—Ü–µ–Ω–∫–∞
            'notes',  # ‚ö†Ô∏è –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ
        ]
```

---

### MEDIUM-001: Pagination –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞

```python
# –ú–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º:
GET /api/v1/nomenclature/?page_size=1000000
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** `MAX_PAGE_SIZE = 100`

---

### MEDIUM-002: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

**–ü—Ä–æ–±–ª–µ–º–∞:** `/api/v1/` –µ—Å—Ç—å, –Ω–æ –Ω–µ—Ç middleware –¥–ª—è version negotiation.

---

### API –¢–µ—Å—Ç-–∫–µ–π—Å—ã

| ID | Endpoint | –ú–µ—Ç–æ–¥ | –¢–µ—Å—Ç | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|-------|------|-----------|
| API-001 | /auth/login/ | POST | –ù–µ–≤–µ—Ä–Ω—ã–µ credentials ‚Üí 401, –Ω–µ 500 | HIGH |
| API-002 | /auth/login/ | POST | SQL injection –≤ username | CRITICAL |
| API-003 | /projects/ | GET | –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401 | HIGH |
| API-004 | /projects/ | POST | –î—É–±–ª–∏–∫–∞—Ç code ‚Üí 400 —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º | HIGH |
| API-005 | /projects/{id}/ | PATCH | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID ‚Üí 404 | MEDIUM |
| API-006 | /projects/{id}/ | DELETE | –ü—Ä–æ–µ–∫—Ç —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ ‚Üí –æ—à–∏–±–∫–∞ | CRITICAL |
| API-007 | /purchase-orders/ | POST | supplier=null ‚Üí 400 | HIGH |
| API-008 | /purchase-orders/{id}/confirm/ | POST | draft ‚Üí confirm (–º–∏–Ω—É—è submitted) | HIGH |
| API-009 | /nomenclature/ | GET | page_size=999999 ‚Üí –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | MEDIUM |
| API-010 | /project-items/ | PATCH | progress_percent=150 ‚Üí 400 | HIGH |
| API-011 | /bom/{id}/clone/ | POST | –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –≤ BOM | CRITICAL |
| API-012 | /contractors/{id}/contacts/ | DELETE | –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç ‚Üí —Ä–∞–∑—Ä–µ—à–∏—Ç—å/–∑–∞–ø—Ä–µ—Ç–∏—Ç—å? | MEDIUM |

---

## 3. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### üî¥ BL-CRIT-001: –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ BOM ‚Üí Project

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ BOM –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø—Ä–æ–µ–∫—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞–Ω –ø—Ä–æ–µ–∫—Ç –∏–∑ BOM v1
2. –í BOM v2 –¥–æ–±–∞–≤–ª–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
3. –ü—Ä–æ–µ–∫—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ —ç—Ç–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–µ–∫–æ–º–ø–ª–µ–∫—Ç–Ω–æ–µ –∏–∑–¥–µ–ª–∏–µ

---

### üî¥ BL-CRIT-002: –ü–µ—Ä–µ—Ä–∞—Å—á—ë—Ç —Å—Ä–æ–∫–æ–≤ –Ω–µ –∫–∞—Å–∫–∞–¥–Ω—ã–π

**–§–∞–π–ª:** `project_tasks.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∑–∞–¥–µ—Ä–∂–∫–µ –¥–æ—á–µ—Ä–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è.

```
–°–±–æ—Ä–∫–∞ A (planned_end: 15.01)
‚îú‚îÄ‚îÄ –î–µ—Ç–∞–ª—å B (planned_end: 10.01) ‚Üí –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ 20.01
‚îî‚îÄ‚îÄ –î–µ—Ç–∞–ª—å C (planned_end: 12.01)

‚ö†Ô∏è –°–±–æ—Ä–∫–∞ A –æ—Å—Ç–∞—ë—Ç—Å—è —Å planned_end: 15.01 ‚Äî –ù–ï–í–û–ó–ú–û–ñ–ù–û!
```

---

### üî¥ BL-CRIT-003: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ "–í —Ä–∞–±–æ—Ç–µ"
2. –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –µ—â—ë –Ω–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã (purchase_status != delivered)
3. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—á–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

---

### HIGH: –ë–∏–∑–Ω–µ—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏

| ID | –ü—Ä–∞–≤–∏–ª–æ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|---------|-------------|-----------|
| BV-001 | –ù–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç —Å –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏ | ‚ùå | CRITICAL |
| BV-002 | –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ | ‚ö†Ô∏è PROTECT | HIGH |
| BV-003 | –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∑–∞–∫–∞–∑–µ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è | ‚ùå | HIGH |
| BV-004 | –°—É–º–º–∞ delivered_quantity ‚â§ quantity | ‚ùå | HIGH |
| BV-005 | contractor –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ manufacturer_type=contractor | ‚ùå | HIGH |
| BV-006 | supplier –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ purchase_status != not_required | ‚ùå | HIGH |
| BV-007 | –î–∞—Ç–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚â• –¥–∞—Ç–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞—á–∞–ª–∞ | ‚ùå | MEDIUM |
| BV-008 | –ü—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ | ‚ùå | MEDIUM |

---

## 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

### üî¥ DB-CRIT-001: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç constraint –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î.

```sql
-- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
ALTER TABLE project_items 
ADD CONSTRAINT chk_progress CHECK (progress_percent >= 0 AND progress_percent <= 100);

ALTER TABLE project_items
ADD CONSTRAINT chk_dates CHECK (actual_start IS NULL OR actual_end IS NULL OR actual_end >= actual_start);

ALTER TABLE purchase_order_items
ADD CONSTRAINT chk_delivered CHECK (delivered_quantity <= quantity);
```

---

### HIGH-001: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```sql
-- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã:
CREATE INDEX idx_project_items_status_date 
ON project_items (manufacturing_status, planned_end) 
WHERE is_active = true;

CREATE INDEX idx_purchase_orders_supplier_status 
ON purchase_orders (supplier_id, status) 
WHERE is_active = true;

CREATE INDEX idx_project_items_overdue
ON project_items (project_id, required_date)
WHERE manufacturing_status != 'completed' 
  AND required_date < CURRENT_DATE;
```

---

### HIGH-002: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å soft delete

**–ü—Ä–æ–±–ª–µ–º–∞:** `ActiveManager` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç `is_active=True`, –Ω–æ:
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç is_active
- –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏

```python
# –°—Ü–µ–Ω–∞—Ä–∏–π:
# 1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—É code="ABC-001"
# 2. –£–¥–∞–ª–∏—Ç—å (is_active=False)
# 3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å code="ABC-001" ‚Äî –û–ö
# 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–≤—É—é ‚Äî –ö–û–ù–§–õ–ò–ö–¢!
```

**–†–µ—à–µ–Ω–∏–µ:**
```sql
CREATE UNIQUE INDEX idx_nomenclature_code_active 
ON nomenclature_items (code) 
WHERE is_active = true;
```

---

### DB –¢–µ—Å—Ç-–∫–µ–π—Å—ã

| ID | –¢–µ—Å—Ç | –û–∂–∏–¥–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|------|----------|-----------|
| DB-001 | –£–¥–∞–ª–∏—Ç—å supplier —Å purchase_orders | PROTECT ‚Äî –æ—à–∏–±–∫–∞ | CRITICAL |
| DB-002 | –£–¥–∞–ª–∏—Ç—å nomenclature_item —Å project_items | CASCADE ‚Äî –æ–ø–∞—Å–Ω–æ! | CRITICAL |
| DB-003 | –í—Å—Ç–∞–≤–∏—Ç—å project_item —Å progress_percent=150 | Constraint violation | HIGH |
| DB-004 | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π UPDATE –æ–¥–Ω–æ–≥–æ project | –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç | HIGH |
| DB-005 | –£–¥–∞–ª–∏—Ç—å catalog_category | CASCADE —É–¥–∞–ª–∏—Ç types | HIGH |
| DB-006 | –°–æ–∑–¥–∞—Ç—å BOM —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π —Å—Å—ã–ª–∫–æ–π | –û—à–∏–±–∫–∞ | CRITICAL |
| DB-007 | Bulk insert 10000 project_items | < 5 —Å–µ–∫ | MEDIUM |
| DB-008 | SELECT –ø—Ä–æ–µ–∫—Ç–∞ —Å 5000 items | < 1 —Å–µ–∫ | HIGH |

---

## 5. Frontend

### üî¥ FE-CRIT-001: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ race conditions

**–§–∞–π–ª:** `pages/projects/ProjectDetailPage.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç.

```typescript
// –ù–µ—Ç optimistic locking –∏–ª–∏ conflict detection
const updateItemMutation = useMutation({
    mutationFn: ({ itemId, data }) => projectsApi.items.update(itemId, data),
    // ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ version/updated_at
});
```

---

### HIGH-001: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

```typescript
onError: () => {
    message.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–¥—Ä—è–¥—á–∏–∫–∞');
    // ‚ö†Ô∏è –ù–µ—Ç –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏
    // ‚ö†Ô∏è –ù–µ—Ç retry –ª–æ–≥–∏–∫–∏
    // ‚ö†Ô∏è –ù–µ—Ç –æ—Ç–∫–∞—Ç–∞ UI state
},
```

---

### HIGH-002: Memory leak –≤ –ø–æ–¥–ø–∏—Å–∫–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ ‚Äî queries –Ω–µ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è.

```typescript
const { data } = useQuery({
    queryKey: ['project-items', id],
    queryFn: () => projectsApi.items.list({ project: id }),
    // ‚ö†Ô∏è –ù–µ—Ç enabled: !!id && !unmounted
    // ‚ö†Ô∏è –ù–µ—Ç signal –¥–ª—è AbortController
});
```

---

### FE –¢–µ—Å—Ç-–∫–µ–π—Å—ã

| ID | –°—Ü–µ–Ω–∞—Ä–∏–π | –û–∂–∏–¥–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|----------|-----------|
| FE-001 | –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ | Redirect –Ω–∞ /login | HIGH |
| FE-002 | –ü–æ—Ç–µ—Ä—è —Å–µ—Ç–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ | –í–Ω—è—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ + retry | HIGH |
| FE-003 | –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç —Å 5000 items | –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è, < 3 —Å–µ–∫ | HIGH |
| FE-004 | –ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏ | –ù–µ—Ç –æ—à–∏–±–æ–∫, –Ω–µ—Ç memory leak | MEDIUM |
| FE-005 | –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" | –û–¥–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ | HIGH |
| FE-006 | –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Ö–æ–¥–∞ | MEDIUM |
| FE-007 | –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–µ | Inline validation | MEDIUM |
| FE-008 | Empty state –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ | LOW |
| FE-009 | Loading state –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π | –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ | MEDIUM |
| FE-010 | 401 –æ—Ç–≤–µ—Ç API | Redirect –Ω–∞ login | CRITICAL |

---

## 6. –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø—ã

### üî¥ SEC-CRIT-001: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç object-level permission

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ï—Å—Ç—å –º–æ–¥–µ–ª—å `Role`, `UserRole`
- –ï—Å—Ç—å django-guardian –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- **–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –õ—é–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
GET /api/v1/projects/  # –í–∏–¥–µ—Ç—å –í–°–ï –ø—Ä–æ–µ–∫—Ç—ã
PATCH /api/v1/purchase-orders/{id}/  # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –õ–Æ–ë–û–ô –∑–∞–∫–∞–∑
DELETE /api/v1/contractors/{id}/  # –£–¥–∞–ª–∏—Ç—å –õ–Æ–ë–û–ì–û –ø–æ–¥—Ä—è–¥—á–∏–∫–∞
```

---

### SEC-CRIT-002: –†–æ–ª–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ API

**–§–∞–π–ª:** `models/users.py` ‚Äî –ï—Å—Ç—å –º–æ–¥–µ–ª—å Role —Å context (project_id)

**–ü—Ä–æ–±–ª–µ–º–∞:** Roles –Ω–∏–≥–¥–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ ViewSets.

---

### –ú–∞—Ç—Ä–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–∞ (–î–û–õ–ñ–ù–ê –ë–´–¢–¨)

| –†–æ–ª—å | –ü—Ä–æ–µ–∫—Ç—ã (—Å–≤–æ–∏) | –ü—Ä–æ–µ–∫—Ç—ã (—á—É–∂–∏–µ) | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ | –ó–∞–∫–∞–∑—ã | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ |
|------|----------------|-----------------|-------------|--------|--------------|
| admin | CRUD | CRUD | CRUD | CRUD | CRUD |
| project_manager | CRUD | R | R | CRUD (—Å–≤–æ–∏) | R |
| engineer | RU | R | R | R | - |
| procurement | R | R | R | CRUD | - |
| viewer | R | R | R | R | - |

---

## 7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Frontend ‚Üî Backend ‚Üî DB

### HIGH-001: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤

**Backend:**
```python
progress_percent = models.DecimalField(max_digits=5, decimal_places=2)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: "45.50" (string –≤ JSON)
```

**Frontend:**
```typescript
progress_percent: number;  // –û–∂–∏–¥–∞–µ—Ç number
```

---

### HIGH-002: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç `version` –∏–ª–∏ `updated_at` –¥–ª—è optimistic locking.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞:**
1. User A –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç (version=1)
2. User B –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç (version=1)
3. User A —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç (version=2)
4. User B —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è A)

---

### HIGH-003: WebSocket –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –¥–ª—è live updates

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö –µ—Å—Ç—å `channels`, –Ω–æ:
- –ù–µ—Ç consumers
- –ù–µ—Ç routing
- Frontend –Ω–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ updates

---

## 8. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

### Celery Tasks Analysis

| Task | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|------|----------|-----------|
| recalculate_project_progress | –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, race condition | CRITICAL |
| recalculate_all_projects | –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É | HIGH |
| take_progress_snapshot | –°—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ | CRITICAL |

**–§–∞–π–ª:** `project_tasks.py:120` ‚Äî `ProgressSnapshot` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –º–æ–¥–µ–ª—è—Ö!

---

### –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ tasks

- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –¥–µ–¥–ª–∞–π–Ω–∞—Ö
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö
- [ ] –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] Backup –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Email –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞

---

## 9. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Unit Tests (Backend)

```python
# tests/test_project_status_transitions.py
class TestProjectStatusTransitions:
    def test_cannot_complete_project_with_pending_items(self):
        project = ProjectFactory(status='in_progress')
        ProjectItemFactory(project=project, status='pending')
        
        with pytest.raises(ValidationError):
            project.status = 'completed'
            project.full_clean()
    
    def test_cannot_change_delivered_order_quantity(self):
        order = PurchaseOrderFactory(status='delivered')
        item = PurchaseOrderItemFactory(order=order, quantity=10)
        
        with pytest.raises(ValidationError):
            item.quantity = 5
            item.save()
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: Integration Tests (API)

```python
# tests/test_api_purchase_orders.py
class TestPurchaseOrderAPI:
    def test_status_transition_validation(self, api_client, purchase_order):
        # draft ‚Üí confirmed should fail (must be submitted first)
        response = api_client.post(
            f'/api/v1/purchase-orders/{purchase_order.id}/confirm/'
        )
        assert response.status_code == 400
        
    def test_cascade_status_update(self, api_client, purchase_order):
        # When order confirmed, items should become 'ordered'
        purchase_order.status = 'submitted'
        purchase_order.save()
        
        response = api_client.post(
            f'/api/v1/purchase-orders/{purchase_order.id}/confirm/'
        )
        
        for item in purchase_order.items.all():
            item.refresh_from_db()
            assert item.status == 'ordered'
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: E2E Tests (Frontend)

```typescript
// cypress/e2e/project-workflow.cy.ts
describe('Project Workflow', () => {
    it('should prevent completing project with pending items', () => {
        cy.login('project_manager');
        cy.visit('/projects/test-project');
        
        cy.get('[data-testid="status-select"]').click();
        cy.get('[data-value="completed"]').click();
        
        cy.get('.ant-message-error')
            .should('contain', '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç');
    });
    
    it('should handle concurrent edits gracefully', () => {
        // Open in two tabs, edit same item, expect conflict handling
    });
});
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: Performance Tests

```python
# locustfile.py
class ProjectLoadTest(HttpUser):
    @task
    def get_project_tree(self):
        self.client.get(f'/api/v1/projects/{project_id}/tree/')
    
    @task
    def update_item_progress(self):
        self.client.patch(
            f'/api/v1/project-items/{item_id}/',
            json={'progress_percent': random.randint(0, 100)}
        )
```

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ Production

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] CORS –æ–≥—Ä–∞–Ω–∏—á–µ–Ω production –¥–æ–º–µ–Ω–∞–º–∏
- [ ] SECRET_KEY —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞—â–∏—â—ë–Ω
- [ ] DEBUG=False –≤ production
- [ ] HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- [ ] SQL injection –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] XSS –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] CSRF –∑–∞—â–∏—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞
- [ ] Object-level permissions —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] N+1 –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [ ] Pagination –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å
- [ ] –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è Celery tasks
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- [ ] Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] Health check endpoints

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞
- [ ] –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Runbook –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏** –ø–µ—Ä–µ–¥ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã:**
1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ object-level permissions
2. Race conditions –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö
3. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ CASCADE —É–¥–∞–ª–µ–Ω–∏—è
4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–∏–∑–Ω–µ—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω:**
1. **–ù–µ–¥–µ–ª—è 1-2:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å CRITICAL issues
2. **–ù–µ–¥–µ–ª—è 3-4:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å permissions, –¥–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. **–ù–µ–¥–µ–ª—è 5-6:** –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏, –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–ù–µ–¥–µ–ª—è 7-8:** Soft launch, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤

---

*–û—Ç—á—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ QA-–∞—É–¥–∏—Ç–∞*
